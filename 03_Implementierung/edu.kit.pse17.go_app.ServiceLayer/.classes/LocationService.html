


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: LocationService</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">edu.kit.pse17.go_app.ServiceLayer</a> ]
</div>

<h1>Coverage Summary for Class: LocationService (edu.kit.pse17.go_app.ServiceLayer)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">LocationService</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 7)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;package edu.kit.pse17.go_app.ServiceLayer;
<i>2</i>&nbsp;
<i>3</i>&nbsp;import edu.kit.pse17.go_app.PersistenceLayer.GoEntity;
<i>4</i>&nbsp;
<i>5</i>&nbsp;import java.util.List;
<i>6</i>&nbsp;import java.util.Map;
<i>7</i>&nbsp;
<i>8</i>&nbsp;/**
<i>9</i>&nbsp; * Diese Klasse bietet eine Schnittstelle für den GOrestController, an die Anfragen, die den User- bzw. Gruppenstandort betreffen, weitergeleitet werden
<i>10</i>&nbsp; * können. Die Aufgabe dieser Klassen ist das Verwalten und Bearbeiten dieser Anfragen.
<i>11</i>&nbsp; *
<i>12</i>&nbsp; * Um die Anfragen bearbeiten zu können, bedient sich die die Klasse dem Clustering Algorithmus, der implementiert ist mit der Schnittstellt, wie sie in dem
<i>13</i>&nbsp; * Interface ClusterStrategy beschrieben ist.
<i>14</i>&nbsp; *
<i>15</i>&nbsp; * Alle Programmteile, die Funktioalitäten aus dieser Klasse benötigen, stellen ihre Anfragen an statische Methoden. Erst innerhalb der Klasse wird
<i>16</i>&nbsp; * die anfrage dem richtigen LocationService-Objekt zugeordnet. Dies erlaubt eine klare Trennung der Teile des GOs, die in der Datenbank verwaltet werden
<i>17</i>&nbsp; * und denen, die in dieser Klasse verwaltet werden.
<i>18</i>&nbsp; *
<i>19</i>&nbsp; * Diese Klasse ist Teil einer Implementierung des Entwurfsmusters &quot;Strategie&quot;. Sie übernimmt die Rolle des Aufrufers, d.h. sie ruft eine Implementierung einer
<i>20</i>&nbsp; * abstrakten Strategie (hier: eine Implementierung von ClusterStrategie) auf, ohne dass des dabei eine Rolle spielt, wie genau die Implementierung aussieht.
<i>21</i>&nbsp; */
<i>22</i>&nbsp;
<i>23</i>&nbsp;public class LocationService {
<i>24</i>&nbsp;
<i>25</i>&nbsp;    /**
<i>26</i>&nbsp;     * Diese Map enthält für jedes gerade aktive GO ein LocationService Objekt, welches die alle dieses GO betreffende
<i>27</i>&nbsp;     * Anfragen übernimmt.
<i>28</i>&nbsp;     *
<i>29</i>&nbsp;     * Der Schlüssel der Map ist die ID des GOs zu dem das LocationService-Objekt gehört. Die maximale Länge der Map beträgt 3000 Wertepaare.
<i>30</i>&nbsp;     *
<i>31</i>&nbsp;     * Ein neues Objekt wird in die Liste eingefügt, wenn die getLocationService()-Methode aufgerufen wird, und dabei kein passender Service gefunden wird. Die
<i>32</i>&nbsp;     * Erstellung der LocationService-Objekte findet ausschließlich in dieser Klasse statt.
<i>33</i>&nbsp;     */
<i>34</i>&nbsp;    private static Map&lt;Long, LocationService&gt; activeServices;
<i>35</i>&nbsp;
<i>36</i>&nbsp;    /**
<i>37</i>&nbsp;     * Ein Clustering-Strategie, die den Algorithmus, der für das Clustering benutzt wird festlegt.
<i>38</i>&nbsp;     * Das Attribut ist final, da es, nachdem es einmal festgelegt wurde nicht mehr verändert werden sollte. Ein GO sollte stattdessen immer den gleichen
<i>39</i>&nbsp;     * Algorithmus benutzen.
<i>40</i>&nbsp;     */
<i>41</i>&nbsp;    private final ClusterStrategy strat;
<i>42</i>&nbsp;
<i>43</i>&nbsp;    /**
<i>44</i>&nbsp;     * Eine Liste mit den UserLocations aller Benutzer, die momentan ihren Standort mit den anderen teilen.
<i>45</i>&nbsp;     * Die Länge der Liste liegt zwischen 0 und 50 UserLocation-Objekten.
<i>46</i>&nbsp;     */
<i>47</i>&nbsp;    List&lt;UserLocation&gt; activeUsers;
<i>48</i>&nbsp;
<i>49</i>&nbsp;    /**
<i>50</i>&nbsp;     * Eine Liste mit den aktuellen Clustern der Standorte des GOs. Diese Liste repräsentiert die Ergebnisse des Clustering für den input
<i>51</i>&nbsp;     * &quot;activeUsers&quot;
<i>52</i>&nbsp;     * Die Länge der Liste liegt zwischen 0 und 50 Cluster-Objekten.
<i>53</i>&nbsp;     */
<i>54</i>&nbsp;    List&lt;Cluster&gt; groupLocation;
<i>55</i>&nbsp;
<i>56</i>&nbsp;    /**
<i>57</i>&nbsp;     * Eine Zählvariable, um sich zu merken, wie viele neue Locations übermittlet wurden, set das letzte Mal die groupLocation
<i>58</i>&nbsp;     * des GOs berechnet wurde. Die Berechnung findet nur statt, wenn diese Variable einen Wert größer als 5 hat. Danach wird der Zähler wieder auf 0 gesetzt.
<i>59</i>&nbsp;     *
<i>60</i>&nbsp;     * Sämtliche Manipulationen an diesem Attribut finden innerhalb dieser Klasse statt. NAch außen hin sit diese Variable nicht sichtbar und insbesondere nicht veränderbar.
<i>61</i>&nbsp;     */
<i>62</i>&nbsp;    private int newLocationCounter;
<i>63</i>&nbsp;
<i>64</i>&nbsp;    /**
<i>65</i>&nbsp;     *Eine Zählvariable, um sich zu merken, wie viele verschiedene Benutzer bereits ihren Standort geteilt haben. Ist diese Zahl kleienr als 3, so wird keine groupLocation
<i>66</i>&nbsp;     * berechnet. Dies dient der Anonymisierung der einzelnen Benutzer, was bei einer Anzahl von UserLocations kleiner als 3 nicht mehr garantiert werden kann.
<i>67</i>&nbsp;     */
<i>68</i>&nbsp;    private int userCounter;
<i>69</i>&nbsp;
<i>70</i>&nbsp;    /**
<i>71</i>&nbsp;     * Der einzige Konstruktor diser Klasse nimmt eine Go-Entity entgegen. Sämtliche Attribute werden nur innerhalb dieser Klasse gesetzt und verändert.
<i>72</i>&nbsp;     * Die default-Werte der Attribute sind:
<i>73</i>&nbsp;     *
<i>74</i>&nbsp;     * - activeUsers: leere Liste
<i>75</i>&nbsp;     * - groupLocation: leere Liste
<i>76</i>&nbsp;     * - strat: Objekt einer Klasse, die ClusterStrategy implementiert. Als threshold-Wert wird dem Konstruktor der Wert aus dem Go-Argument übergeben.
<i>77</i>&nbsp;     * - newLocationCounter: 0
<i>78</i>&nbsp;     * - userCounter: 0
<i>79</i>&nbsp;     */
<b class="nc"><i>80</i>&nbsp;    public LocationService(GoEntity go) {</b>
<b class="nc"><i>81</i>&nbsp;        this.activeUsers = activeUsers;</b>
<b class="nc"><i>82</i>&nbsp;        this.groupLocation = groupLocation;</b>
<b class="nc"><i>83</i>&nbsp;        this.newLocationCounter = 0;</b>
<b class="nc"><i>84</i>&nbsp;        this.userCounter = 0;</b>
<b class="nc"><i>85</i>&nbsp;        this.strat = new GoClusterStrategy();</b>
<i>86</i>&nbsp;    }
<i>87</i>&nbsp;
<i>88</i>&nbsp;    /**
<i>89</i>&nbsp;     * Diese Methode speichert eine UserLocation in der acitveUsers Liste des entsprechenden GOs.
<i>90</i>&nbsp;     * Sie wird aufgerufen von der GoRestController Klasse, wenn diese eine setLocation-Anfrage von einem Benutzer bekommt.
<i>91</i>&nbsp;     *
<i>92</i>&nbsp;     * Bei einem Methodenaufruf wird aus der Liste der activeGos das richtige locationService Objekt ausgewählt und dort die userLocation in der activeUsers Liste aktualisert.
<i>93</i>&nbsp;     * Sollte dieses Objekt in der Liste nicht existierten, wird es erzeugt und der Liste hinzugefügt. In diesem Fall wird die Variable userCounter um eines erhöht, da
<i>94</i>&nbsp;     * ein neuer Benutzer angefangen hat, seinen Standort zu teilen.
<i>95</i>&nbsp;     *
<i>96</i>&nbsp;     * Bei jedem Aufruf dieser Methode wird außerdem der Wert von newLocationCounter um 1 erhöht.
<i>97</i>&nbsp;     *
<i>98</i>&nbsp;     * Sollte das GO in der Map activeGos nicht zu finden sein, wird ein neues LocationService-Objekt erzeugt und der Map hinzugefügt.
<i>99</i>&nbsp;     *
<i>100</i>&nbsp;     * @param goId Die ID des GOs zu dem die Location gehört. Es muss eine gültige ID eines GOs sein. Sie wird verwendet, um den richtigen locationService aus
<i>101</i>&nbsp;     *             einer statischen Map zu finden.
<i>102</i>&nbsp;     * @param userId Die ID des Benutzers, zu dem der Standort gehört. Es muss sich um eine gültige Benutzer-ID handeln.
<i>103</i>&nbsp;     * @param lat Der geographische Breitengrad des Standorts des Benutzers. Der Wert muss als Breitengrad interpretierbar sein,
<i>104</i>&nbsp;     * muss also zwischen +90 und -90 liegen.
<i>105</i>&nbsp;     * @param lon Der geographische Längengrad des Standorts des Benutzers. Der Wert muss als Längengrad interpretierbar sein,
<i>106</i>&nbsp;     * muss also zwischen +180 und -180 liegen.
<i>107</i>&nbsp;     */
<i>108</i>&nbsp;    public static void setUserLocation(long goId, String userId, long lat, long lon) {
<i>109</i>&nbsp;
<i>110</i>&nbsp;    }
<i>111</i>&nbsp;
<i>112</i>&nbsp;    /**
<i>113</i>&nbsp;     * Gibt die aktuelle GroupLocation des spezifizierten GOs an den Aufrufer zurück.
<i>114</i>&nbsp;     * Aufgerufen wird diese Methode von einem GoRestController, der von einem Client eine Anfrage nach der groupLocation eines GOs bekommen hat.
<i>115</i>&nbsp;     *
<i>116</i>&nbsp;     * Bei einem Methodenaufruf wird das entsprechende GO aus der Map activeGos anhand der goId herausgesucht. Es ist dabei garantiert,
<i>117</i>&nbsp;     * dass das GO in der Map zu finden ist. Aus dem locationService-Objekts des Gos wird zuerst der Wert des newLocationCounters betrachtet. Ist dieser größer
<i>118</i>&nbsp;     * oder gleich 5, wird die ClusterStrategy aufgerufen und die groupLocation neu berechnet. Anschließend wird der newLocationCounter zurückgesetzt und
<i>119</i>&nbsp;     * die groupLocation wird zurückgegeben.
<i>120</i>&nbsp;     *
<i>121</i>&nbsp;     * @param goId Die ID des GOs, dessen groupLocation gesucht wird. Dabei handelt es sich um eine gültige GO-ID, die ein Schlüssel in der Map acitve GOs ist.
<i>122</i>&nbsp;     *
<i>123</i>&nbsp;     * @return Eine Liste mit Cluster-Objekten. Diese stellt den aktuellen Standort der GO-Teilnehmer dar. Dabei ist die Länge der Liste zwischen 0 und 50.
<i>124</i>&nbsp;     * Ist die Liste leer, hei?t das, dass noch nicht genügend Teilnehmer ihren Standort übermittelt haben, um eine groupLocation ausrechnen zu können, ohne die
<i>125</i>&nbsp;     * Anonymisierungs-Vorschriften der Anwendung zu verletzen.
<i>126</i>&nbsp;     */
<i>127</i>&nbsp;    public static List&lt;Cluster&gt; getGroupLocation(long goId) {
<b class="nc"><i>128</i>&nbsp;        return null;</b>
<i>129</i>&nbsp;    }
<i>130</i>&nbsp;
<i>131</i>&nbsp;}
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2017-07-27 10:31</div>
</div>
</body>
</html>
